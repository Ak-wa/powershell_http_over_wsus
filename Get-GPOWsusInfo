function Get-GPOWsusInfo {
    $GPO = Get-GPO -All
    foreach ($Policy in $GPO) {
        $GPOID = $Policy.Id
        $GPODisp = $Policy.DisplayName

        $xml = Get-GPOReport -Id $GPOID -ReportType xml -ErrorAction SilentlyContinue

        $WSUSServer = $null
        $WSUSBase = Get-GPRegistryValue -Guid $GPOID -Key 'HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate' -ErrorAction SilentlyContinue

        if ($WSUSBase -and $WSUSBase.Count -gt 0) {
            $WSUSServerValue = $WSUSBase | Where-Object { $_.ValueName -eq 'WUServer' }
            if ($WSUSServerValue -and $WSUSServerValue.Count -gt 0) {
                $WSUSServer = $WSUSServerValue.Value
            }
        }

        if ($GPODisp -and $WSUSServer) {
            [PSCustomObject]@{
                GPOName = $GPODisp
                WSUSServer = $WSUSServer
            }
        }
    }
}

Get-GPOWsusInfo -ErrorAction SilentlyContinue
In this script, I've added checks to ensure that both $WSUSBase and $WSUSServerValue arrays exist and have elements before attempting to access their properties. I've also included -ErrorAction SilentlyContinue when calling the Get-GPOWsusInfo function to suppress any potential errors. This should fulfill your requirement of absolutely not displaying any errors.





